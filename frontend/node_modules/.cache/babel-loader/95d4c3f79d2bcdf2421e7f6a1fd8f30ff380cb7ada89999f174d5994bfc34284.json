{"ast":null,"code":"var _jsxFileName = \"/Users/simbatmotsi/Documents/Projects/virtual-lawyer/frontend/src/contexts/NotificationsContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport apiRequest from '../utils/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NotificationsProvider = ({\n  children\n}) => {\n  _s();\n  const [notifications, setNotifications] = useState([]);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const fetchNotifications = async () => {\n    try {\n      setLoading(true);\n      const response = await apiRequest.get('/api/notifications/');\n      setNotifications(response.data || []);\n      setUnreadCount(response.data.filter(notification => !notification.read).length);\n      setError(null);\n    } catch (err) {\n      console.error('Failed to fetch notifications:', err);\n      setError('Failed to load notifications');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const markAsRead = async notificationId => {\n    try {\n      await apiRequest.patch(`/api/notifications/${notificationId}/`, {\n        read: true\n      });\n\n      // Update local state\n      setNotifications(notifications.map(notification => notification.id === notificationId ? {\n        ...notification,\n        read: true\n      } : notification));\n      setUnreadCount(prev => Math.max(0, prev - 1));\n      return true;\n    } catch (err) {\n      console.error('Failed to mark notification as read:', err);\n      return false;\n    }\n  };\n  const markAllAsRead = async () => {\n    try {\n      await apiRequest.post('/api/notifications/mark-all-read/');\n\n      // Update local state\n      setNotifications(notifications.map(notification => ({\n        ...notification,\n        read: true\n      })));\n      setUnreadCount(0);\n      return true;\n    } catch (err) {\n      console.error('Failed to mark all notifications as read:', err);\n      return false;\n    }\n  };\n\n  // Fetch notifications when the component mounts\n  useEffect(() => {\n    fetchNotifications();\n\n    // Set up polling for new notifications (every 60 seconds)\n    const intervalId = setInterval(fetchNotifications, 60000);\n    return () => clearInterval(intervalId);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(NotificationsContext.Provider, {\n    value: {\n      notifications,\n      unreadCount,\n      loading,\n      error,\n      fetchNotifications,\n      markAsRead,\n      markAllAsRead\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n};\n\n// Create context\n_s(NotificationsProvider, \"luGxckMMpZuJ/EnbdxvGERjh3AQ=\");\n_c = NotificationsProvider;\nconst NotificationsContext = /*#__PURE__*/React.createContext(null);\n\n// Hook for using the notifications context\nexport const useNotifications = () => {\n  _s2();\n  const context = React.useContext(NotificationsContext);\n  if (!context) {\n    throw new Error('useNotifications must be used within a NotificationsProvider');\n  }\n  return context;\n};\n_s2(useNotifications, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport default NotificationsProvider;\nvar _c;\n$RefreshReg$(_c, \"NotificationsProvider\");","map":{"version":3,"names":["React","useState","useEffect","apiRequest","jsxDEV","_jsxDEV","NotificationsProvider","children","_s","notifications","setNotifications","unreadCount","setUnreadCount","loading","setLoading","error","setError","fetchNotifications","response","get","data","filter","notification","read","length","err","console","markAsRead","notificationId","patch","map","id","prev","Math","max","markAllAsRead","post","intervalId","setInterval","clearInterval","NotificationsContext","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","createContext","useNotifications","_s2","context","useContext","Error","$RefreshReg$"],"sources":["/Users/simbatmotsi/Documents/Projects/virtual-lawyer/frontend/src/contexts/NotificationsContext.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport apiRequest from '../utils/api';\n\nconst NotificationsProvider = ({ children }) => {\n  const [notifications, setNotifications] = useState([]);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const fetchNotifications = async () => {\n    try {\n      setLoading(true);\n      const response = await apiRequest.get('/api/notifications/');\n      setNotifications(response.data || []);\n      setUnreadCount(response.data.filter(notification => !notification.read).length);\n      setError(null);\n    } catch (err) {\n      console.error('Failed to fetch notifications:', err);\n      setError('Failed to load notifications');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const markAsRead = async (notificationId) => {\n    try {\n      await apiRequest.patch(`/api/notifications/${notificationId}/`, { read: true });\n      \n      // Update local state\n      setNotifications(notifications.map(notification => \n        notification.id === notificationId \n          ? { ...notification, read: true } \n          : notification\n      ));\n      \n      setUnreadCount(prev => Math.max(0, prev - 1));\n      return true;\n    } catch (err) {\n      console.error('Failed to mark notification as read:', err);\n      return false;\n    }\n  };\n\n  const markAllAsRead = async () => {\n    try {\n      await apiRequest.post('/api/notifications/mark-all-read/');\n      \n      // Update local state\n      setNotifications(notifications.map(notification => ({ ...notification, read: true })));\n      setUnreadCount(0);\n      return true;\n    } catch (err) {\n      console.error('Failed to mark all notifications as read:', err);\n      return false;\n    }\n  };\n\n  // Fetch notifications when the component mounts\n  useEffect(() => {\n    fetchNotifications();\n    \n    // Set up polling for new notifications (every 60 seconds)\n    const intervalId = setInterval(fetchNotifications, 60000);\n    \n    return () => clearInterval(intervalId);\n  }, []);\n\n  return (\n    <NotificationsContext.Provider \n      value={{ \n        notifications, \n        unreadCount, \n        loading, \n        error, \n        fetchNotifications, \n        markAsRead, \n        markAllAsRead \n      }}\n    >\n      {children}\n    </NotificationsContext.Provider>\n  );\n};\n\n// Create context\nconst NotificationsContext = React.createContext(null);\n\n// Hook for using the notifications context\nexport const useNotifications = () => {\n  const context = React.useContext(NotificationsContext);\n  if (!context) {\n    throw new Error('useNotifications must be used within a NotificationsProvider');\n  }\n  return context;\n};\n\nexport default NotificationsProvider;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}