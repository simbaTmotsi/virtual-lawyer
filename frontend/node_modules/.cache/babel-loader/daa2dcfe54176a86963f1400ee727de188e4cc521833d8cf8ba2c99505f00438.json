{"ast":null,"code":"var _jsxFileName = \"/Users/simbatmotsi/Documents/Projects/virtual-lawyer/frontend/src/contexts/NotificationsContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { api } from '../utils/api';\n\n// Create context\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NotificationsContext = /*#__PURE__*/React.createContext(null);\nconst NotificationsProvider = ({\n  children\n}) => {\n  _s();\n  const [notifications, setNotifications] = useState([]);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const fetchNotifications = async () => {\n    try {\n      setLoading(true);\n      const response = await api.get('/notifications/');\n      const notificationData = response.data || [];\n      setNotifications(notificationData);\n      setUnreadCount(notificationData.filter(notification => !notification.read).length);\n      setError(null);\n    } catch (err) {\n      console.error('Failed to fetch notifications:', err);\n      setError('Failed to load notifications');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const markAsRead = async notificationId => {\n    try {\n      await api.patch(`/notifications/${notificationId}/`, {\n        read: true\n      });\n\n      // Update local state\n      setNotifications(notifications.map(notification => notification.id === notificationId ? {\n        ...notification,\n        read: true\n      } : notification));\n      setUnreadCount(prev => Math.max(0, prev - 1));\n      return true;\n    } catch (err) {\n      console.error('Failed to mark notification as read:', err);\n      return false;\n    }\n  };\n  const markAllAsRead = async () => {\n    try {\n      await api.post('/notifications/mark-all-read/');\n\n      // Update local state\n      setNotifications(notifications.map(notification => ({\n        ...notification,\n        read: true\n      })));\n      setUnreadCount(0);\n      return true;\n    } catch (err) {\n      console.error('Failed to mark all notifications as read:', err);\n      return false;\n    }\n  };\n\n  // Fetch notifications when the component mounts\n  useEffect(() => {\n    fetchNotifications();\n\n    // Set up polling for new notifications (every 60 seconds)\n    const intervalId = setInterval(fetchNotifications, 60000);\n    return () => clearInterval(intervalId);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(NotificationsContext.Provider, {\n    value: {\n      notifications,\n      unreadCount,\n      loading,\n      error,\n      fetchNotifications,\n      markAsRead,\n      markAllAsRead\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n};\n\n// Hook for using the notifications context\n_s(NotificationsProvider, \"luGxckMMpZuJ/EnbdxvGERjh3AQ=\");\n_c = NotificationsProvider;\nexport const useNotifications = () => {\n  _s2();\n  const context = React.useContext(NotificationsContext);\n  if (!context) {\n    throw new Error('useNotifications must be used within a NotificationsProvider');\n  }\n  return context;\n};\n_s2(useNotifications, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport default NotificationsProvider;\nvar _c;\n$RefreshReg$(_c, \"NotificationsProvider\");","map":{"version":3,"names":["React","useState","useEffect","api","jsxDEV","_jsxDEV","NotificationsContext","createContext","NotificationsProvider","children","_s","notifications","setNotifications","unreadCount","setUnreadCount","loading","setLoading","error","setError","fetchNotifications","response","get","notificationData","data","filter","notification","read","length","err","console","markAsRead","notificationId","patch","map","id","prev","Math","max","markAllAsRead","post","intervalId","setInterval","clearInterval","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useNotifications","_s2","context","useContext","Error","$RefreshReg$"],"sources":["/Users/simbatmotsi/Documents/Projects/virtual-lawyer/frontend/src/contexts/NotificationsContext.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { api } from '../utils/api';\n\n// Create context\nconst NotificationsContext = React.createContext(null);\n\nconst NotificationsProvider = ({ children }) => {\n  const [notifications, setNotifications] = useState([]);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const fetchNotifications = async () => {\n    try {\n      setLoading(true);\n      const response = await api.get('/notifications/');\n      const notificationData = response.data || [];\n      setNotifications(notificationData);\n      setUnreadCount(notificationData.filter(notification => !notification.read).length);\n      setError(null);\n    } catch (err) {\n      console.error('Failed to fetch notifications:', err);\n      setError('Failed to load notifications');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const markAsRead = async (notificationId) => {\n    try {\n      await api.patch(`/notifications/${notificationId}/`, { read: true });\n      \n      // Update local state\n      setNotifications(notifications.map(notification => \n        notification.id === notificationId \n          ? { ...notification, read: true } \n          : notification\n      ));\n      \n      setUnreadCount(prev => Math.max(0, prev - 1));\n      return true;\n    } catch (err) {\n      console.error('Failed to mark notification as read:', err);\n      return false;\n    }\n  };\n\n  const markAllAsRead = async () => {\n    try {\n      await api.post('/notifications/mark-all-read/');\n      \n      // Update local state\n      setNotifications(notifications.map(notification => ({ ...notification, read: true })));\n      setUnreadCount(0);\n      return true;\n    } catch (err) {\n      console.error('Failed to mark all notifications as read:', err);\n      return false;\n    }\n  };\n\n  // Fetch notifications when the component mounts\n  useEffect(() => {\n    fetchNotifications();\n    \n    // Set up polling for new notifications (every 60 seconds)\n    const intervalId = setInterval(fetchNotifications, 60000);\n    \n    return () => clearInterval(intervalId);\n  }, []);\n\n  return (\n    <NotificationsContext.Provider \n      value={{ \n        notifications, \n        unreadCount, \n        loading, \n        error, \n        fetchNotifications, \n        markAsRead, \n        markAllAsRead \n      }}\n    >\n      {children}\n    </NotificationsContext.Provider>\n  );\n};\n\n// Hook for using the notifications context\nexport const useNotifications = () => {\n  const context = React.useContext(NotificationsContext);\n  if (!context) {\n    throw new Error('useNotifications must be used within a NotificationsProvider');\n  }\n  return context;\n};\n\nexport default NotificationsProvider;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}