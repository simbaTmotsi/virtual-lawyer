{"ast":null,"code":"var _jsxFileName = \"/Users/simbatmotsi/Documents/Projects/virtual-lawyer/frontend/src/pages/billing/CreateInvoice.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { format } from 'date-fns';\nimport { apiRequest } from '../../utils/api';\nimport DashboardLayout from '../../components/layouts/DashboardLayout';\nimport Breadcrumb from '../../components/ui/Breadcrumb';\nimport { toast } from '../../utils/notification';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CreateInvoice = () => {\n  _s();\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [clients, setClients] = useState([]);\n  const [timeEntries, setTimeEntries] = useState([]);\n  const [expenses, setExpenses] = useState([]);\n  const [filteredTimeEntries, setFilteredTimeEntries] = useState([]);\n  const [filteredExpenses, setFilteredExpenses] = useState([]);\n  const [selectedEntries, setSelectedEntries] = useState([]);\n  const [selectedExpenses, setSelectedExpenses] = useState([]);\n  const [totalHours, setTotalHours] = useState(0);\n  const [totalAmount, setTotalAmount] = useState(0);\n  const [totalExpenseAmount, setTotalExpenseAmount] = useState(0);\n  const [activeTab, setActiveTab] = useState('time-entries');\n  const [invoiceData, setInvoiceData] = useState({\n    client: '',\n    issue_date: format(new Date(), 'yyyy-MM-dd'),\n    due_date: format(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), 'yyyy-MM-dd'),\n    notes: ''\n  });\n\n  // Fetch clients\n  useEffect(() => {\n    const fetchClients = async () => {\n      try {\n        const response = await apiRequest('/api/clients/');\n        setClients(response);\n      } catch (error) {\n        console.error('Error fetching clients:', error);\n        toast.error('Failed to load clients');\n      }\n    };\n    fetchClients();\n  }, []);\n\n  // Fetch unbilled time entries\n  useEffect(() => {\n    const fetchTimeEntries = async () => {\n      try {\n        const response = await apiRequest('/api/billing/time-entries/unbilled/');\n        setTimeEntries(response);\n      } catch (error) {\n        console.error('Error fetching time entries:', error);\n        toast.error('Failed to load time entries');\n      }\n    };\n    fetchTimeEntries();\n  }, []);\n\n  // Fetch unbilled expenses\n  useEffect(() => {\n    const fetchExpenses = async () => {\n      try {\n        const response = await apiRequest('/api/billing/expenses/unbilled/');\n        setExpenses(response);\n      } catch (error) {\n        console.error('Error fetching expenses:', error);\n        toast.error('Failed to load expenses');\n      }\n    };\n    fetchExpenses();\n  }, []);\n\n  // Filter time entries and expenses when client changes\n  useEffect(() => {\n    if (invoiceData.client) {\n      const filteredEntries = timeEntries.filter(entry => entry.case_detail && entry.case_detail.client === parseInt(invoiceData.client));\n      setFilteredTimeEntries(filteredEntries);\n      const filteredClientExpenses = expenses.filter(expense => expense.case_detail && expense.case_detail.client === parseInt(invoiceData.client));\n      setFilteredExpenses(filteredClientExpenses);\n    } else {\n      setFilteredTimeEntries([]);\n      setFilteredExpenses([]);\n    }\n\n    // Clear selected items when client changes\n    setSelectedEntries([]);\n    setSelectedExpenses([]);\n    updateTotals([], []);\n  }, [invoiceData.client, timeEntries, expenses]);\n\n  // Update totals when selected items change\n  const updateTotals = (entries, expenses) => {\n    const entryHours = entries.reduce((sum, entry) => sum + parseFloat(entry.hours), 0);\n    const entryAmount = entries.reduce((sum, entry) => sum + parseFloat(entry.amount), 0);\n    const expenseAmount = expenses.reduce((sum, expense) => sum + parseFloat(expense.amount), 0);\n    setTotalHours(entryHours);\n    setTotalAmount(entryAmount);\n    setTotalExpenseAmount(expenseAmount);\n  };\n\n  // Handle form input changes\n  const handleInputChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setInvoiceData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  // Toggle time entry selection\n  const toggleEntrySelection = entry => {\n    let newSelectedEntries;\n    if (selectedEntries.some(e => e.id === entry.id)) {\n      newSelectedEntries = selectedEntries.filter(e => e.id !== entry.id);\n    } else {\n      newSelectedEntries = [...selectedEntries, entry];\n    }\n    setSelectedEntries(newSelectedEntries);\n    updateTotals(newSelectedEntries, selectedExpenses);\n  };\n\n  // Toggle expense selection\n  const toggleExpenseSelection = expense => {\n    let newSelectedExpenses;\n    if (selectedExpenses.some(e => e.id === expense.id)) {\n      newSelectedExpenses = selectedExpenses.filter(e => e.id !== expense.id);\n    } else {\n      newSelectedExpenses = [...selectedExpenses, expense];\n    }\n    setSelectedExpenses(newSelectedExpenses);\n    updateTotals(selectedEntries, newSelectedExpenses);\n  };\n\n  // Select all time entries or expenses\n  const selectAllEntries = () => {\n    if (activeTab === 'time-entries') {\n      if (selectedEntries.length === filteredTimeEntries.length) {\n        setSelectedEntries([]);\n        updateTotals([], selectedExpenses);\n      } else {\n        setSelectedEntries([...filteredTimeEntries]);\n        updateTotals(filteredTimeEntries, selectedExpenses);\n      }\n    } else {\n      if (selectedExpenses.length === filteredExpenses.length) {\n        setSelectedExpenses([]);\n        updateTotals(selectedEntries, []);\n      } else {\n        setSelectedExpenses([...filteredExpenses]);\n        updateTotals(selectedEntries, filteredExpenses);\n      }\n    }\n  };\n\n  // Handle form submission\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!invoiceData.client) {\n      toast.error('Please select a client');\n      return;\n    }\n    if (selectedEntries.length === 0 && selectedExpenses.length === 0) {\n      toast.error('Please select at least one time entry or expense');\n      return;\n    }\n    setLoading(true);\n    try {\n      // First create the invoice\n      const invoicePayload = {\n        client: invoiceData.client,\n        issue_date: invoiceData.issue_date,\n        due_date: invoiceData.due_date,\n        notes: invoiceData.notes,\n        status: 'draft'\n      };\n      const invoice = await apiRequest('/api/billing/invoices/', 'POST', invoicePayload);\n\n      // Then add time entries to the invoice if any are selected\n      if (selectedEntries.length > 0) {\n        const entryIds = selectedEntries.map(entry => entry.id);\n        await apiRequest(`/api/billing/invoices/${invoice.id}/add_time_entries/`, 'POST', {\n          time_entry_ids: entryIds\n        });\n      }\n\n      // Then add expenses to the invoice if any are selected\n      if (selectedExpenses.length > 0) {\n        const expenseIds = selectedExpenses.map(expense => expense.id);\n        await apiRequest(`/api/billing/invoices/${invoice.id}/add_expenses/`, 'POST', {\n          expense_ids: expenseIds\n        });\n      }\n      toast.success('Invoice created successfully');\n      navigate(`/billing/invoices/${invoice.id}`);\n    } catch (error) {\n      console.error('Error creating invoice:', error);\n      toast.error('Failed to create invoice');\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(DashboardLayout, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-4 py-4 sm:px-6 lg:px-8\",\n      children: [/*#__PURE__*/_jsxDEV(Breadcrumb, {\n        items: [{\n          name: 'Home',\n          href: '/'\n        }, {\n          name: 'Billing',\n          href: '/billing'\n        }, {\n          name: 'Invoices',\n          href: '/billing/invoices'\n        }, {\n          name: 'Create Invoice',\n          href: '/billing/invoices/new'\n        }]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-semibold text-gray-900\",\n          children: \"Create New Invoice\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6 bg-white shadow rounded-lg p-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-lg font-medium text-gray-900\",\n            children: \"Invoice Details\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-4 grid grid-cols-1 gap-y-6 sm:grid-cols-6 sm:gap-x-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"sm:col-span-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"client\",\n                className: \"block text-sm font-medium text-gray-700\",\n                children: \"Client *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                id: \"client\",\n                name: \"client\",\n                value: invoiceData.client,\n                onChange: handleInputChange,\n                required: true,\n                className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\",\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"Select a client\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 19\n                }, this), clients.map(client => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: client.id,\n                  children: client.full_name || `${client.first_name} ${client.last_name}`\n                }, client.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 255,\n                  columnNumber: 21\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"sm:col-span-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700\",\n                children: \"Invoice Number\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-1 block w-full py-2 px-3 border border-gray-300 bg-gray-100 rounded-md shadow-sm text-gray-500 sm:text-sm\",\n                children: \"Will be generated automatically\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"sm:col-span-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"issue_date\",\n                className: \"block text-sm font-medium text-gray-700\",\n                children: \"Issue Date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                id: \"issue_date\",\n                name: \"issue_date\",\n                value: invoiceData.issue_date,\n                onChange: handleInputChange,\n                required: true,\n                className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 276,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 272,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"sm:col-span-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"due_date\",\n                className: \"block text-sm font-medium text-gray-700\",\n                children: \"Due Date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 288,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"date\",\n                id: \"due_date\",\n                name: \"due_date\",\n                value: invoiceData.due_date,\n                onChange: handleInputChange,\n                required: true,\n                className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 291,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"sm:col-span-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"notes\",\n                className: \"block text-sm font-medium text-gray-700\",\n                children: \"Notes\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                id: \"notes\",\n                name: \"notes\",\n                rows: 3,\n                value: invoiceData.notes,\n                onChange: handleInputChange,\n                className: \"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\",\n                placeholder: \"Additional notes to the client\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6 bg-white shadow rounded-lg p-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border-b border-gray-200\",\n            children: /*#__PURE__*/_jsxDEV(\"nav\", {\n              className: \"-mb-px flex space-x-8\",\n              \"aria-label\": \"Tabs\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setActiveTab('time-entries'),\n                className: `${activeTab === 'time-entries' ? 'border-primary-500 text-primary-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,\n                children: \"Time Entries\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 323,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setActiveTab('expenses'),\n                className: `${activeTab === 'expenses' ? 'border-primary-500 text-primary-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,\n                children: \"Expenses\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-4\",\n            children: activeTab === 'time-entries' ? /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between items-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"text-lg font-medium text-gray-900\",\n                  children: \"Time Entries\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 350,\n                  columnNumber: 21\n                }, this), filteredTimeEntries.length > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: selectAllEntries,\n                  className: \"text-sm text-primary-600 hover:text-primary-900\",\n                  children: selectedEntries.length === filteredTimeEntries.length ? 'Deselect All' : 'Select All'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 353,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 349,\n                columnNumber: 19\n              }, this), !invoiceData.client ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"py-12 text-center\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-gray-500\",\n                  children: \"Please select a client to view billable time entries.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 367,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 366,\n                columnNumber: 21\n              }, this) : filteredTimeEntries.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"py-12 text-center\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-gray-500\",\n                  children: \"No unbilled time entries found for this client.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 371,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 370,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-4 overflow-hidden border-b border-gray-200 sm:rounded-lg\",\n                children: /*#__PURE__*/_jsxDEV(\"table\", {\n                  className: \"min-w-full divide-y divide-gray-200\",\n                  children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                    className: \"bg-gray-50\",\n                    children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                        children: /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"sr-only\",\n                          children: \"Select\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 379,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 378,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                        children: \"Date\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 381,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                        children: \"Case\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 384,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                        children: \"Description\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 387,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                        children: \"Hours\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 390,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                        children: \"Amount\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 393,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 377,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 376,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                    className: \"bg-white divide-y divide-gray-200\",\n                    children: filteredTimeEntries.map(entry => {\n                      var _entry$case_detail, _entry$case_detail2;\n                      return /*#__PURE__*/_jsxDEV(\"tr\", {\n                        onClick: () => toggleEntrySelection(entry),\n                        className: selectedEntries.some(e => e.id === entry.id) ? 'bg-primary-50 cursor-pointer' : 'hover:bg-gray-50 cursor-pointer',\n                        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                          className: \"px-6 py-4 whitespace-nowrap\",\n                          children: /*#__PURE__*/_jsxDEV(\"input\", {\n                            type: \"checkbox\",\n                            checked: selectedEntries.some(e => e.id === entry.id),\n                            onChange: () => toggleEntrySelection(entry),\n                            className: \"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 409,\n                            columnNumber: 33\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 408,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          className: \"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",\n                          children: entry.date\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 416,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          className: \"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",\n                          children: ((_entry$case_detail = entry.case_detail) === null || _entry$case_detail === void 0 ? void 0 : _entry$case_detail.title) || ((_entry$case_detail2 = entry.case_detail) === null || _entry$case_detail2 === void 0 ? void 0 : _entry$case_detail2.case_number) || 'N/A'\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 419,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          className: \"px-6 py-4 text-sm text-gray-900 max-w-md truncate\",\n                          children: entry.description\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 422,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          className: \"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",\n                          children: entry.hours\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 425,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          className: \"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",\n                          children: [\"$\", parseFloat(entry.amount).toFixed(2)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 428,\n                          columnNumber: 31\n                        }, this)]\n                      }, entry.id, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 400,\n                        columnNumber: 29\n                      }, this);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 398,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 375,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 374,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between items-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"text-lg font-medium text-gray-900\",\n                  children: \"Expenses\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 441,\n                  columnNumber: 21\n                }, this), filteredExpenses.length > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: selectAllEntries,\n                  className: \"text-sm text-primary-600 hover:text-primary-900\",\n                  children: selectedExpenses.length === filteredExpenses.length ? 'Deselect All' : 'Select All'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 444,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 440,\n                columnNumber: 19\n              }, this), !invoiceData.client ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"py-12 text-center\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-gray-500\",\n                  children: \"Please select a client to view billable expenses.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 458,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 457,\n                columnNumber: 21\n              }, this) : filteredExpenses.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"py-12 text-center\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-gray-500\",\n                  children: \"No unbilled expenses found for this client.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 462,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 461,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-4 overflow-hidden border-b border-gray-200 sm:rounded-lg\",\n                children: /*#__PURE__*/_jsxDEV(\"table\", {\n                  className: \"min-w-full divide-y divide-gray-200\",\n                  children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                    className: \"bg-gray-50\",\n                    children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                        children: /*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"sr-only\",\n                          children: \"Select\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 470,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 469,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                        children: \"Date\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 472,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                        children: \"Case\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 475,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                        children: \"Description\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 478,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        className: \"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",\n                        children: \"Amount\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 481,\n                        columnNumber: 29\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 468,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 467,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                    className: \"bg-white divide-y divide-gray-200\",\n                    children: filteredExpenses.map(expense => {\n                      var _expense$case_detail, _expense$case_detail2;\n                      return /*#__PURE__*/_jsxDEV(\"tr\", {\n                        onClick: () => toggleExpenseSelection(expense),\n                        className: selectedExpenses.some(e => e.id === expense.id) ? 'bg-primary-50 cursor-pointer' : 'hover:bg-gray-50 cursor-pointer',\n                        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                          className: \"px-6 py-4 whitespace-nowrap\",\n                          children: /*#__PURE__*/_jsxDEV(\"input\", {\n                            type: \"checkbox\",\n                            checked: selectedExpenses.some(e => e.id === expense.id),\n                            onChange: () => toggleExpenseSelection(expense),\n                            className: \"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 497,\n                            columnNumber: 33\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 496,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          className: \"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",\n                          children: expense.date\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 504,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          className: \"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",\n                          children: ((_expense$case_detail = expense.case_detail) === null || _expense$case_detail === void 0 ? void 0 : _expense$case_detail.title) || ((_expense$case_detail2 = expense.case_detail) === null || _expense$case_detail2 === void 0 ? void 0 : _expense$case_detail2.case_number) || 'N/A'\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 507,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          className: \"px-6 py-4 text-sm text-gray-900 max-w-md truncate\",\n                          children: expense.description\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 510,\n                          columnNumber: 31\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          className: \"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",\n                          children: [\"$\", parseFloat(expense.amount).toFixed(2)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 513,\n                          columnNumber: 31\n                        }, this)]\n                      }, expense.id, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 488,\n                        columnNumber: 29\n                      }, this);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 486,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 466,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 465,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 439,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 13\n          }, this), (selectedEntries.length > 0 || selectedExpenses.length > 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-6 flex justify-between border-t border-gray-200 pt-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-gray-500\",\n                children: [\"Selected items: \", selectedEntries.length + selectedExpenses.length]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 530,\n                columnNumber: 19\n              }, this), selectedEntries.length > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-gray-500\",\n                children: [\"Time entries: \", selectedEntries.length, \" (\", totalHours.toFixed(2), \" hours)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 534,\n                columnNumber: 21\n              }, this), selectedExpenses.length > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-gray-500\",\n                children: [\"Expenses: \", selectedExpenses.length]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 539,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 529,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-lg font-semibold text-gray-900\",\n                children: [\"Total Amount: $\", (totalAmount + totalExpenseAmount).toFixed(2)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 545,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 544,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 528,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6 flex justify-end\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => navigate('/billing/invoices'),\n            className: \"mr-3 inline-flex justify-center py-2 px-4 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 555,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            disabled: loading || selectedEntries.length === 0 && selectedExpenses.length === 0,\n            className: \"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50\",\n            children: loading ? 'Creating...' : 'Create Invoice'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 562,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 220,\n    columnNumber: 5\n  }, this);\n};\n_s(CreateInvoice, \"L/m+xJ5F2TPDUQZsTf7MipONWN4=\", false, function () {\n  return [useNavigate];\n});\n_c = CreateInvoice;\nexport default CreateInvoice;\nvar _c;\n$RefreshReg$(_c, \"CreateInvoice\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","format","apiRequest","DashboardLayout","Breadcrumb","toast","jsxDEV","_jsxDEV","CreateInvoice","_s","navigate","loading","setLoading","clients","setClients","timeEntries","setTimeEntries","expenses","setExpenses","filteredTimeEntries","setFilteredTimeEntries","filteredExpenses","setFilteredExpenses","selectedEntries","setSelectedEntries","selectedExpenses","setSelectedExpenses","totalHours","setTotalHours","totalAmount","setTotalAmount","totalExpenseAmount","setTotalExpenseAmount","activeTab","setActiveTab","invoiceData","setInvoiceData","client","issue_date","Date","due_date","now","notes","fetchClients","response","error","console","fetchTimeEntries","fetchExpenses","filteredEntries","filter","entry","case_detail","parseInt","filteredClientExpenses","expense","updateTotals","entries","entryHours","reduce","sum","parseFloat","hours","entryAmount","amount","expenseAmount","handleInputChange","e","name","value","target","prev","toggleEntrySelection","newSelectedEntries","some","id","toggleExpenseSelection","newSelectedExpenses","selectAllEntries","length","handleSubmit","preventDefault","invoicePayload","status","invoice","entryIds","map","time_entry_ids","expenseIds","expense_ids","success","children","className","items","href","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","htmlFor","onChange","required","full_name","first_name","last_name","type","rows","placeholder","onClick","scope","_entry$case_detail","_entry$case_detail2","checked","date","title","case_number","description","toFixed","_expense$case_detail","_expense$case_detail2","disabled","_c","$RefreshReg$"],"sources":["/Users/simbatmotsi/Documents/Projects/virtual-lawyer/frontend/src/pages/billing/CreateInvoice.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { format } from 'date-fns';\nimport { apiRequest } from '../../utils/api';\nimport DashboardLayout from '../../components/layouts/DashboardLayout';\nimport Breadcrumb from '../../components/ui/Breadcrumb';\nimport { toast } from '../../utils/notification';\n\nconst CreateInvoice = () => {\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [clients, setClients] = useState([]);\n  const [timeEntries, setTimeEntries] = useState([]);\n  const [expenses, setExpenses] = useState([]);\n  const [filteredTimeEntries, setFilteredTimeEntries] = useState([]);\n  const [filteredExpenses, setFilteredExpenses] = useState([]);\n  const [selectedEntries, setSelectedEntries] = useState([]);\n  const [selectedExpenses, setSelectedExpenses] = useState([]);\n  const [totalHours, setTotalHours] = useState(0);\n  const [totalAmount, setTotalAmount] = useState(0);\n  const [totalExpenseAmount, setTotalExpenseAmount] = useState(0);\n  const [activeTab, setActiveTab] = useState('time-entries');\n\n  const [invoiceData, setInvoiceData] = useState({\n    client: '',\n    issue_date: format(new Date(), 'yyyy-MM-dd'),\n    due_date: format(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), 'yyyy-MM-dd'),\n    notes: '',\n  });\n\n  // Fetch clients\n  useEffect(() => {\n    const fetchClients = async () => {\n      try {\n        const response = await apiRequest('/api/clients/');\n        setClients(response);\n      } catch (error) {\n        console.error('Error fetching clients:', error);\n        toast.error('Failed to load clients');\n      }\n    };\n\n    fetchClients();\n  }, []);\n\n  // Fetch unbilled time entries\n  useEffect(() => {\n    const fetchTimeEntries = async () => {\n      try {\n        const response = await apiRequest('/api/billing/time-entries/unbilled/');\n        setTimeEntries(response);\n      } catch (error) {\n        console.error('Error fetching time entries:', error);\n        toast.error('Failed to load time entries');\n      }\n    };\n\n    fetchTimeEntries();\n  }, []);\n\n  // Fetch unbilled expenses\n  useEffect(() => {\n    const fetchExpenses = async () => {\n      try {\n        const response = await apiRequest('/api/billing/expenses/unbilled/');\n        setExpenses(response);\n      } catch (error) {\n        console.error('Error fetching expenses:', error);\n        toast.error('Failed to load expenses');\n      }\n    };\n\n    fetchExpenses();\n  }, []);\n\n  // Filter time entries and expenses when client changes\n  useEffect(() => {\n    if (invoiceData.client) {\n      const filteredEntries = timeEntries.filter(entry =>\n        entry.case_detail && entry.case_detail.client === parseInt(invoiceData.client)\n      );\n      setFilteredTimeEntries(filteredEntries);\n\n      const filteredClientExpenses = expenses.filter(expense =>\n        expense.case_detail && expense.case_detail.client === parseInt(invoiceData.client)\n      );\n      setFilteredExpenses(filteredClientExpenses);\n    } else {\n      setFilteredTimeEntries([]);\n      setFilteredExpenses([]);\n    }\n\n    // Clear selected items when client changes\n    setSelectedEntries([]);\n    setSelectedExpenses([]);\n    updateTotals([], []);\n  }, [invoiceData.client, timeEntries, expenses]);\n\n  // Update totals when selected items change\n  const updateTotals = (entries, expenses) => {\n    const entryHours = entries.reduce((sum, entry) => sum + parseFloat(entry.hours), 0);\n    const entryAmount = entries.reduce((sum, entry) => sum + parseFloat(entry.amount), 0);\n    const expenseAmount = expenses.reduce((sum, expense) => sum + parseFloat(expense.amount), 0);\n\n    setTotalHours(entryHours);\n    setTotalAmount(entryAmount);\n    setTotalExpenseAmount(expenseAmount);\n  };\n\n  // Handle form input changes\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setInvoiceData(prev => ({ ...prev, [name]: value }));\n  };\n\n  // Toggle time entry selection\n  const toggleEntrySelection = (entry) => {\n    let newSelectedEntries;\n\n    if (selectedEntries.some(e => e.id === entry.id)) {\n      newSelectedEntries = selectedEntries.filter(e => e.id !== entry.id);\n    } else {\n      newSelectedEntries = [...selectedEntries, entry];\n    }\n\n    setSelectedEntries(newSelectedEntries);\n    updateTotals(newSelectedEntries, selectedExpenses);\n  };\n\n  // Toggle expense selection\n  const toggleExpenseSelection = (expense) => {\n    let newSelectedExpenses;\n\n    if (selectedExpenses.some(e => e.id === expense.id)) {\n      newSelectedExpenses = selectedExpenses.filter(e => e.id !== expense.id);\n    } else {\n      newSelectedExpenses = [...selectedExpenses, expense];\n    }\n\n    setSelectedExpenses(newSelectedExpenses);\n    updateTotals(selectedEntries, newSelectedExpenses);\n  };\n\n  // Select all time entries or expenses\n  const selectAllEntries = () => {\n    if (activeTab === 'time-entries') {\n      if (selectedEntries.length === filteredTimeEntries.length) {\n        setSelectedEntries([]);\n        updateTotals([], selectedExpenses);\n      } else {\n        setSelectedEntries([...filteredTimeEntries]);\n        updateTotals(filteredTimeEntries, selectedExpenses);\n      }\n    } else {\n      if (selectedExpenses.length === filteredExpenses.length) {\n        setSelectedExpenses([]);\n        updateTotals(selectedEntries, []);\n      } else {\n        setSelectedExpenses([...filteredExpenses]);\n        updateTotals(selectedEntries, filteredExpenses);\n      }\n    }\n  };\n\n  // Handle form submission\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!invoiceData.client) {\n      toast.error('Please select a client');\n      return;\n    }\n\n    if (selectedEntries.length === 0 && selectedExpenses.length === 0) {\n      toast.error('Please select at least one time entry or expense');\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      // First create the invoice\n      const invoicePayload = {\n        client: invoiceData.client,\n        issue_date: invoiceData.issue_date,\n        due_date: invoiceData.due_date,\n        notes: invoiceData.notes,\n        status: 'draft',\n      };\n\n      const invoice = await apiRequest('/api/billing/invoices/', 'POST', invoicePayload);\n\n      // Then add time entries to the invoice if any are selected\n      if (selectedEntries.length > 0) {\n        const entryIds = selectedEntries.map(entry => entry.id);\n        await apiRequest(`/api/billing/invoices/${invoice.id}/add_time_entries/`, 'POST', {\n          time_entry_ids: entryIds\n        });\n      }\n\n      // Then add expenses to the invoice if any are selected\n      if (selectedExpenses.length > 0) {\n        const expenseIds = selectedExpenses.map(expense => expense.id);\n        await apiRequest(`/api/billing/invoices/${invoice.id}/add_expenses/`, 'POST', {\n          expense_ids: expenseIds\n        });\n      }\n\n      toast.success('Invoice created successfully');\n      navigate(`/billing/invoices/${invoice.id}`);\n    } catch (error) {\n      console.error('Error creating invoice:', error);\n      toast.error('Failed to create invoice');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <DashboardLayout>\n      <div className=\"px-4 py-4 sm:px-6 lg:px-8\">\n        <Breadcrumb\n          items={[\n            { name: 'Home', href: '/' },\n            { name: 'Billing', href: '/billing' },\n            { name: 'Invoices', href: '/billing/invoices' },\n            { name: 'Create Invoice', href: '/billing/invoices/new' },\n          ]}\n        />\n\n        <div className=\"mt-4\">\n          <h1 className=\"text-2xl font-semibold text-gray-900\">Create New Invoice</h1>\n        </div>\n\n        <form onSubmit={handleSubmit}>\n          {/* Invoice Details */}\n          <div className=\"mt-6 bg-white shadow rounded-lg p-6\">\n            <h2 className=\"text-lg font-medium text-gray-900\">Invoice Details</h2>\n\n            <div className=\"mt-4 grid grid-cols-1 gap-y-6 sm:grid-cols-6 sm:gap-x-4\">\n              <div className=\"sm:col-span-3\">\n                <label htmlFor=\"client\" className=\"block text-sm font-medium text-gray-700\">\n                  Client *\n                </label>\n                <select\n                  id=\"client\"\n                  name=\"client\"\n                  value={invoiceData.client}\n                  onChange={handleInputChange}\n                  required\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"\n                >\n                  <option value=\"\">Select a client</option>\n                  {clients.map(client => (\n                    <option key={client.id} value={client.id}>\n                      {client.full_name || `${client.first_name} ${client.last_name}`}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div className=\"sm:col-span-3\">\n                {/* Placeholder for invoice number - will be auto-generated */}\n                <label className=\"block text-sm font-medium text-gray-700\">\n                  Invoice Number\n                </label>\n                <div className=\"mt-1 block w-full py-2 px-3 border border-gray-300 bg-gray-100 rounded-md shadow-sm text-gray-500 sm:text-sm\">\n                  Will be generated automatically\n                </div>\n              </div>\n\n              <div className=\"sm:col-span-3\">\n                <label htmlFor=\"issue_date\" className=\"block text-sm font-medium text-gray-700\">\n                  Issue Date\n                </label>\n                <input\n                  type=\"date\"\n                  id=\"issue_date\"\n                  name=\"issue_date\"\n                  value={invoiceData.issue_date}\n                  onChange={handleInputChange}\n                  required\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"\n                />\n              </div>\n\n              <div className=\"sm:col-span-3\">\n                <label htmlFor=\"due_date\" className=\"block text-sm font-medium text-gray-700\">\n                  Due Date\n                </label>\n                <input\n                  type=\"date\"\n                  id=\"due_date\"\n                  name=\"due_date\"\n                  value={invoiceData.due_date}\n                  onChange={handleInputChange}\n                  required\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"\n                />\n              </div>\n\n              <div className=\"sm:col-span-6\">\n                <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700\">\n                  Notes\n                </label>\n                <textarea\n                  id=\"notes\"\n                  name=\"notes\"\n                  rows={3}\n                  value={invoiceData.notes}\n                  onChange={handleInputChange}\n                  className=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"\n                  placeholder=\"Additional notes to the client\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Time Entries and Expenses Tabs */}\n          <div className=\"mt-6 bg-white shadow rounded-lg p-6\">\n            <div className=\"border-b border-gray-200\">\n              <nav className=\"-mb-px flex space-x-8\" aria-label=\"Tabs\">\n                <button\n                  onClick={() => setActiveTab('time-entries')}\n                  className={`${\n                    activeTab === 'time-entries'\n                      ? 'border-primary-500 text-primary-600'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                  } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Time Entries\n                </button>\n                <button\n                  onClick={() => setActiveTab('expenses')}\n                  className={`${\n                    activeTab === 'expenses'\n                      ? 'border-primary-500 text-primary-600'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                  } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Expenses\n                </button>\n              </nav>\n            </div>\n\n            <div className=\"mt-4\">\n              {activeTab === 'time-entries' ? (\n                <div>\n                  <div className=\"flex justify-between items-center\">\n                    <h2 className=\"text-lg font-medium text-gray-900\">Time Entries</h2>\n\n                    {filteredTimeEntries.length > 0 && (\n                      <button\n                        type=\"button\"\n                        onClick={selectAllEntries}\n                        className=\"text-sm text-primary-600 hover:text-primary-900\"\n                      >\n                        {selectedEntries.length === filteredTimeEntries.length\n                          ? 'Deselect All'\n                          : 'Select All'}\n                      </button>\n                    )}\n                  </div>\n\n                  {!invoiceData.client ? (\n                    <div className=\"py-12 text-center\">\n                      <p className=\"text-gray-500\">Please select a client to view billable time entries.</p>\n                    </div>\n                  ) : filteredTimeEntries.length === 0 ? (\n                    <div className=\"py-12 text-center\">\n                      <p className=\"text-gray-500\">No unbilled time entries found for this client.</p>\n                    </div>\n                  ) : (\n                    <div className=\"mt-4 overflow-hidden border-b border-gray-200 sm:rounded-lg\">\n                      <table className=\"min-w-full divide-y divide-gray-200\">\n                        <thead className=\"bg-gray-50\">\n                          <tr>\n                            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                              <span className=\"sr-only\">Select</span>\n                            </th>\n                            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                              Date\n                            </th>\n                            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                              Case\n                            </th>\n                            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                              Description\n                            </th>\n                            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                              Hours\n                            </th>\n                            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                              Amount\n                            </th>\n                          </tr>\n                        </thead>\n                        <tbody className=\"bg-white divide-y divide-gray-200\">\n                          {filteredTimeEntries.map((entry) => (\n                            <tr \n                              key={entry.id}\n                              onClick={() => toggleEntrySelection(entry)}\n                              className={selectedEntries.some(e => e.id === entry.id) \n                                ? 'bg-primary-50 cursor-pointer' \n                                : 'hover:bg-gray-50 cursor-pointer'\n                              }\n                            >\n                              <td className=\"px-6 py-4 whitespace-nowrap\">\n                                <input\n                                  type=\"checkbox\"\n                                  checked={selectedEntries.some(e => e.id === entry.id)}\n                                  onChange={() => toggleEntrySelection(entry)}\n                                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\n                                />\n                              </td>\n                              <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                                {entry.date}\n                              </td>\n                              <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                                {entry.case_detail?.title || entry.case_detail?.case_number || 'N/A'}\n                              </td>\n                              <td className=\"px-6 py-4 text-sm text-gray-900 max-w-md truncate\">\n                                {entry.description}\n                              </td>\n                              <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                                {entry.hours}\n                              </td>\n                              <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                                ${parseFloat(entry.amount).toFixed(2)}\n                              </td>\n                            </tr>\n                          ))}\n                        </tbody>\n                      </table>\n                    </div>\n                  )}\n                </div>\n              ) : (\n                <div>\n                  <div className=\"flex justify-between items-center\">\n                    <h2 className=\"text-lg font-medium text-gray-900\">Expenses</h2>\n\n                    {filteredExpenses.length > 0 && (\n                      <button\n                        type=\"button\"\n                        onClick={selectAllEntries}\n                        className=\"text-sm text-primary-600 hover:text-primary-900\"\n                      >\n                        {selectedExpenses.length === filteredExpenses.length\n                          ? 'Deselect All'\n                          : 'Select All'}\n                      </button>\n                    )}\n                  </div>\n\n                  {!invoiceData.client ? (\n                    <div className=\"py-12 text-center\">\n                      <p className=\"text-gray-500\">Please select a client to view billable expenses.</p>\n                    </div>\n                  ) : filteredExpenses.length === 0 ? (\n                    <div className=\"py-12 text-center\">\n                      <p className=\"text-gray-500\">No unbilled expenses found for this client.</p>\n                    </div>\n                  ) : (\n                    <div className=\"mt-4 overflow-hidden border-b border-gray-200 sm:rounded-lg\">\n                      <table className=\"min-w-full divide-y divide-gray-200\">\n                        <thead className=\"bg-gray-50\">\n                          <tr>\n                            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                              <span className=\"sr-only\">Select</span>\n                            </th>\n                            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                              Date\n                            </th>\n                            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                              Case\n                            </th>\n                            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                              Description\n                            </th>\n                            <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                              Amount\n                            </th>\n                          </tr>\n                        </thead>\n                        <tbody className=\"bg-white divide-y divide-gray-200\">\n                          {filteredExpenses.map((expense) => (\n                            <tr \n                              key={expense.id}\n                              onClick={() => toggleExpenseSelection(expense)}\n                              className={selectedExpenses.some(e => e.id === expense.id) \n                                ? 'bg-primary-50 cursor-pointer' \n                                : 'hover:bg-gray-50 cursor-pointer'\n                              }\n                            >\n                              <td className=\"px-6 py-4 whitespace-nowrap\">\n                                <input\n                                  type=\"checkbox\"\n                                  checked={selectedExpenses.some(e => e.id === expense.id)}\n                                  onChange={() => toggleExpenseSelection(expense)}\n                                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\n                                />\n                              </td>\n                              <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                                {expense.date}\n                              </td>\n                              <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                                {expense.case_detail?.title || expense.case_detail?.case_number || 'N/A'}\n                              </td>\n                              <td className=\"px-6 py-4 text-sm text-gray-900 max-w-md truncate\">\n                                {expense.description}\n                              </td>\n                              <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                                ${parseFloat(expense.amount).toFixed(2)}\n                              </td>\n                            </tr>\n                          ))}\n                        </tbody>\n                      </table>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n\n            {/* Summary section showing combined totals */}\n            {(selectedEntries.length > 0 || selectedExpenses.length > 0) && (\n              <div className=\"mt-6 flex justify-between border-t border-gray-200 pt-4\">\n                <div>\n                  <p className=\"text-sm text-gray-500\">\n                    Selected items: {selectedEntries.length + selectedExpenses.length}\n                  </p>\n                  {selectedEntries.length > 0 && (\n                    <p className=\"text-sm text-gray-500\">\n                      Time entries: {selectedEntries.length} ({totalHours.toFixed(2)} hours)\n                    </p>\n                  )}\n                  {selectedExpenses.length > 0 && (\n                    <p className=\"text-sm text-gray-500\">\n                      Expenses: {selectedExpenses.length}\n                    </p>\n                  )}\n                </div>\n                <div>\n                  <p className=\"text-lg font-semibold text-gray-900\">\n                    Total Amount: ${(totalAmount + totalExpenseAmount).toFixed(2)}\n                  </p>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Submit Button */}\n          <div className=\"mt-6 flex justify-end\">\n            <button\n              type=\"button\"\n              onClick={() => navigate('/billing/invoices')}\n              className=\"mr-3 inline-flex justify-center py-2 px-4 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              disabled={loading || (selectedEntries.length === 0 && selectedExpenses.length === 0)}\n              className=\"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50\"\n            >\n              {loading ? 'Creating...' : 'Create Invoice'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </DashboardLayout>\n  );\n};\n\nexport default CreateInvoice;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}