{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{Link,useNavigate,useSearchParams}from'react-router-dom';import{ArrowLeftIcon,DocumentTextIcon}from'@heroicons/react/24/outline';import apiRequest from'../../utils/api';import{toast}from'../../utils/notification';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CreateInvoice=()=>{const navigate=useNavigate();const[searchParams]=useSearchParams();const initialClientId=searchParams.get('client');const[loading,setLoading]=useState(false);const[clients,setClients]=useState([]);const[timeEntries,setTimeEntries]=useState([]);const[expenses,setExpenses]=useState([]);const[selectedTimeEntries,setSelectedTimeEntries]=useState([]);const[selectedExpenses,setSelectedExpenses]=useState([]);const[formData,setFormData]=useState({client:initialClientId||'',issue_date:new Date().toISOString().split('T')[0],due_date:new Date(Date.now()+30*24*60*60*1000).toISOString().split('T')[0],notes:''});const[totalAmount,setTotalAmount]=useState(0);const[error,setError]=useState(null);useEffect(()=>{fetchClients();if(initialClientId){fetchUnbilledItems(initialClientId);}},[initialClientId,fetchUnbilledItems]);const fetchClients=async()=>{try{const data=await apiRequest('/api/clients/');setClients(data||[]);}catch(err){console.error('Failed to fetch clients:',err);setError('Failed to load clients. Please try again.');}};const fetchUnbilledItems=useCallback(async clientId=>{if(!clientId)return;try{// Fetch unbilled time entries for this client\nconst timeEntriesData=await apiRequest(`/api/billing/time-entries/?client_id=${clientId}&invoiced=false&billable=true`);setTimeEntries(timeEntriesData||[]);// Fetch unbilled expenses for this client\nconst expensesData=await apiRequest(`/api/billing/expenses/?client_id=${clientId}&invoiced=false&billable=true`);setExpenses(expensesData||[]);// Auto-select all items if there are any\nsetSelectedTimeEntries(timeEntriesData?timeEntriesData.map(entry=>entry.id):[]);setSelectedExpenses(expensesData?expensesData.map(expense=>expense.id):[]);// Calculate initial total\ncalculateTotal(timeEntriesData||[],expensesData||[]);}catch(err){console.error('Failed to fetch unbilled items:',err);setError('Failed to load unbilled items. Please try again.');}},[]);const calculateTotal=function(){let timeEntries=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];let expenses=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];const timeTotal=timeEntries.reduce((sum,entry)=>sum+parseFloat(entry.amount),0);const expenseTotal=expenses.reduce((sum,expense)=>sum+parseFloat(expense.amount),0);setTotalAmount(timeTotal+expenseTotal);};const handleClientChange=async e=>{const clientId=e.target.value;setFormData({...formData,client:clientId});// Clear selected items when client changes\nsetSelectedTimeEntries([]);setSelectedExpenses([]);setTimeEntries([]);setExpenses([]);if(clientId){fetchUnbilledItems(clientId);}};const handleFormChange=e=>{const{name,value}=e.target;setFormData({...formData,[name]:value});};const handleTimeEntrySelection=id=>{const newSelected=selectedTimeEntries.includes(id)?selectedTimeEntries.filter(entryId=>entryId!==id):[...selectedTimeEntries,id];setSelectedTimeEntries(newSelected);// Calculate total based on new selection\nconst selectedEntries=timeEntries.filter(entry=>newSelected.includes(entry.id));calculateTotal(selectedEntries,expenses.filter(expense=>selectedExpenses.includes(expense.id)));};const handleExpenseSelection=id=>{const newSelected=selectedExpenses.includes(id)?selectedExpenses.filter(expenseId=>expenseId!==id):[...selectedExpenses,id];setSelectedExpenses(newSelected);// Calculate total based on new selection\nconst selectedExps=expenses.filter(expense=>newSelected.includes(expense.id));calculateTotal(timeEntries.filter(entry=>selectedTimeEntries.includes(entry.id)),selectedExps);};const handleSelectAll=type=>{if(type==='time'){const allIds=timeEntries.map(entry=>entry.id);setSelectedTimeEntries(selectedTimeEntries.length===timeEntries.length?[]:allIds);calculateTotal(selectedTimeEntries.length===timeEntries.length?[]:timeEntries,expenses.filter(expense=>selectedExpenses.includes(expense.id)));}else{const allIds=expenses.map(expense=>expense.id);setSelectedExpenses(selectedExpenses.length===expenses.length?[]:allIds);calculateTotal(timeEntries.filter(entry=>selectedTimeEntries.includes(entry.id)),selectedExpenses.length===expenses.length?[]:expenses);}};const handleSubmit=async e=>{e.preventDefault();if(!formData.client){setError('Please select a client');return;}if(selectedTimeEntries.length===0&&selectedExpenses.length===0){setError('Please select at least one time entry or expense');return;}setLoading(true);setError(null);try{// Create the invoice\nconst invoiceData=await apiRequest('/api/billing/invoices/','POST',formData);// Add time entries to the invoice\nif(selectedTimeEntries.length>0){await apiRequest(`/api/billing/invoices/${invoiceData.id}/add_time_entries/`,'POST',{time_entry_ids:selectedTimeEntries});}// Add expenses to the invoice\nif(selectedExpenses.length>0){await apiRequest(`/api/billing/invoices/${invoiceData.id}/add_expenses/`,'POST',{expense_ids:selectedExpenses});}toast.success('Invoice created successfully');navigate(`/billing/invoices/${invoiceData.id}`);}catch(err){console.error('Failed to create invoice:',err);setError('Failed to create invoice. Please try again.');}finally{setLoading(false);}};const formatDate=dateString=>{if(!dateString)return'N/A';const date=new Date(dateString);return new Intl.DateTimeFormat('en-US',{year:'numeric',month:'short',day:'numeric'}).format(date);};const formatCurrency=amount=>{return`$${parseFloat(amount).toFixed(2)}`;};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 pb-4 border-b border-gray-200 dark:border-gray-700\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/billing/invoices\",className:\"text-sm text-primary-600 dark:text-primary-400 hover:underline flex items-center mb-2\",children:[/*#__PURE__*/_jsx(ArrowLeftIcon,{className:\"h-4 w-4 mr-1\"}),\" Back to Invoices\"]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold text-gray-900 dark:text-white\",children:\"Create New Invoice\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"rounded-md bg-red-50 dark:bg-red-900/30 p-4 mb-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"ml-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-red-800 dark:text-red-200\",children:\"Error\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-sm text-red-700 dark:text-red-300\",children:/*#__PURE__*/_jsx(\"p\",{children:error})})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white dark:bg-gray-800 shadow dark:shadow-gray-700/10 rounded-lg\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b border-gray-200 dark:border-gray-700\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 dark:text-white mb-4\",children:\"Invoice Details\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"client\",className:\"block text-sm font-medium text-gray-700 dark:text-gray-300\",children:[\"Client \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsxs(\"select\",{id:\"client\",name:\"client\",value:formData.client,onChange:handleClientChange,required:true,className:\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:text-white\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a client\"}),clients.map(client=>/*#__PURE__*/_jsxs(\"option\",{value:client.id,children:[client.first_name,\" \",client.last_name]},client.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"invoice_number\",className:\"block text-sm font-medium text-gray-700 dark:text-gray-300\",children:\"Invoice Number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"invoice_number\",name:\"invoice_number\",disabled:true,value:\"Auto-generated\",className:\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-600\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"issue_date\",className:\"block text-sm font-medium text-gray-700 dark:text-gray-300\",children:[\"Issue Date \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",id:\"issue_date\",name:\"issue_date\",value:formData.issue_date,onChange:handleFormChange,required:true,className:\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:text-white\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"due_date\",className:\"block text-sm font-medium text-gray-700 dark:text-gray-300\",children:[\"Due Date \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",id:\"due_date\",name:\"due_date\",value:formData.due_date,onChange:handleFormChange,required:true,className:\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:text-white\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"notes\",className:\"block text-sm font-medium text-gray-700 dark:text-gray-300\",children:\"Notes\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"notes\",name:\"notes\",rows:\"3\",value:formData.notes,onChange:handleFormChange,className:\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:text-white\",placeholder:\"Additional notes or payment instructions...\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b border-gray-200 dark:border-gray-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 dark:text-white\",children:\"Time Entries\"}),timeEntries.length>0&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleSelectAll('time'),className:\"text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 text-sm font-medium\",children:selectedTimeEntries.length===timeEntries.length?'Deselect All':'Select All'})]}),!formData.client?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 dark:text-gray-400\",children:\"Please select a client to view unbilled time entries.\"}):timeEntries.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 dark:text-gray-400\",children:\"No unbilled time entries for this client.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50 dark:bg-gray-700\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Select\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Staff\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",className:\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Hours\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",className:\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Rate\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",className:\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Amount\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\",children:timeEntries.map(entry=>/*#__PURE__*/_jsxs(\"tr\",{className:`cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 ${selectedTimeEntries.includes(entry.id)?'bg-blue-50 dark:bg-blue-900/20':''}`,onClick:()=>handleTimeEntrySelection(entry.id),children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedTimeEntries.includes(entry.id),onChange:()=>handleTimeEntrySelection(entry.id),className:\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300\",children:formatDate(entry.date)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm text-gray-500 dark:text-gray-300\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-xs truncate\",children:entry.description})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300\",children:entry.user_detail?`${entry.user_detail.first_name} ${entry.user_detail.last_name}`:'Unknown'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right\",children:parseFloat(entry.hours).toFixed(2)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right\",children:formatCurrency(entry.rate)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right\",children:formatCurrency(entry.amount)})]},entry.id))})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b border-gray-200 dark:border-gray-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 dark:text-white\",children:\"Expenses\"}),expenses.length>0&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleSelectAll('expense'),className:\"text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 text-sm font-medium\",children:selectedExpenses.length===expenses.length?'Deselect All':'Select All'})]}),!formData.client?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 dark:text-gray-400\",children:\"Please select a client to view unbilled expenses.\"}):expenses.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 dark:text-gray-400\",children:\"No unbilled expenses for this client.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50 dark:bg-gray-700\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Select\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",className:\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\",children:\"Amount\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\",children:expenses.map(expense=>/*#__PURE__*/_jsxs(\"tr\",{className:`cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 ${selectedExpenses.includes(expense.id)?'bg-blue-50 dark:bg-blue-900/20':''}`,onClick:()=>handleExpenseSelection(expense.id),children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedExpenses.includes(expense.id),onChange:()=>handleExpenseSelection(expense.id),className:\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300\",children:formatDate(expense.date)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm text-gray-500 dark:text-gray-300\",children:expense.description}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right\",children:formatCurrency(expense.amount)})]},expense.id))})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-end\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-500 dark:text-gray-400 text-sm\",children:[selectedTimeEntries.length,\" time entries selected \\u2022 \",selectedExpenses.length,\" expenses selected\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-400\",children:\"Total Amount\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-gray-900 dark:text-white\",children:formatCurrency(totalAmount)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(Link,{to:\"/billing/invoices\",className:\"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading||!formData.client||selectedTimeEntries.length===0&&selectedExpenses.length===0,className:\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50\",children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Creating...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(DocumentTextIcon,{className:\"h-5 w-5 mr-2\"}),\"Create Invoice\"]})})]})]})]})})]})})]});};export default CreateInvoice;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Link","useNavigate","useSearchParams","ArrowLeftIcon","DocumentTextIcon","apiRequest","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CreateInvoice","navigate","searchParams","initialClientId","get","loading","setLoading","clients","setClients","timeEntries","setTimeEntries","expenses","setExpenses","selectedTimeEntries","setSelectedTimeEntries","selectedExpenses","setSelectedExpenses","formData","setFormData","client","issue_date","Date","toISOString","split","due_date","now","notes","totalAmount","setTotalAmount","error","setError","fetchClients","fetchUnbilledItems","data","err","console","clientId","timeEntriesData","expensesData","map","entry","id","expense","calculateTotal","arguments","length","undefined","timeTotal","reduce","sum","parseFloat","amount","expenseTotal","handleClientChange","e","target","value","handleFormChange","name","handleTimeEntrySelection","newSelected","includes","filter","entryId","selectedEntries","handleExpenseSelection","expenseId","selectedExps","handleSelectAll","type","allIds","handleSubmit","preventDefault","invoiceData","time_entry_ids","expense_ids","success","formatDate","dateString","date","Intl","DateTimeFormat","year","month","day","format","formatCurrency","toFixed","children","className","to","onSubmit","htmlFor","onChange","required","first_name","last_name","disabled","rows","placeholder","onClick","scope","checked","description","user_detail","hours","rate","xmlns","fill","viewBox","cx","cy","r","stroke","strokeWidth","d"],"sources":["/Users/simbatmotsi/Documents/Projects/virtual-lawyer/frontend/src/pages/billing/CreateInvoice.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { Link, useNavigate, useSearchParams } from 'react-router-dom';\nimport { \n  ArrowLeftIcon, \n  DocumentTextIcon \n} from '@heroicons/react/24/outline';\nimport apiRequest from '../../utils/api';\nimport { toast } from '../../utils/notification';\n\nconst CreateInvoice = () => {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const initialClientId = searchParams.get('client');\n  \n  const [loading, setLoading] = useState(false);\n  const [clients, setClients] = useState([]);\n  const [timeEntries, setTimeEntries] = useState([]);\n  const [expenses, setExpenses] = useState([]);\n  const [selectedTimeEntries, setSelectedTimeEntries] = useState([]);\n  const [selectedExpenses, setSelectedExpenses] = useState([]);\n  const [formData, setFormData] = useState({\n    client: initialClientId || '',\n    issue_date: new Date().toISOString().split('T')[0],\n    due_date: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n    notes: '',\n  });\n  const [totalAmount, setTotalAmount] = useState(0);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    fetchClients();\n    if (initialClientId) {\n      fetchUnbilledItems(initialClientId);\n    }\n  }, [initialClientId, fetchUnbilledItems]);\n\n  const fetchClients = async () => {\n    try {\n      const data = await apiRequest('/api/clients/');\n      setClients(data || []);\n    } catch (err) {\n      console.error('Failed to fetch clients:', err);\n      setError('Failed to load clients. Please try again.');\n    }\n  };\n\n  const fetchUnbilledItems = useCallback(async (clientId) => {\n    if (!clientId) return;\n    \n    try {\n      // Fetch unbilled time entries for this client\n      const timeEntriesData = await apiRequest(`/api/billing/time-entries/?client_id=${clientId}&invoiced=false&billable=true`);\n      setTimeEntries(timeEntriesData || []);\n      \n      // Fetch unbilled expenses for this client\n      const expensesData = await apiRequest(`/api/billing/expenses/?client_id=${clientId}&invoiced=false&billable=true`);\n      setExpenses(expensesData || []);\n      \n      // Auto-select all items if there are any\n      setSelectedTimeEntries(timeEntriesData ? timeEntriesData.map(entry => entry.id) : []);\n      setSelectedExpenses(expensesData ? expensesData.map(expense => expense.id) : []);\n      \n      // Calculate initial total\n      calculateTotal(timeEntriesData || [], expensesData || []);\n    } catch (err) {\n      console.error('Failed to fetch unbilled items:', err);\n      setError('Failed to load unbilled items. Please try again.');\n    }\n  }, []);\n\n  const calculateTotal = (timeEntries = [], expenses = []) => {\n    const timeTotal = timeEntries.reduce((sum, entry) => sum + parseFloat(entry.amount), 0);\n    const expenseTotal = expenses.reduce((sum, expense) => sum + parseFloat(expense.amount), 0);\n    setTotalAmount(timeTotal + expenseTotal);\n  };\n\n  const handleClientChange = async (e) => {\n    const clientId = e.target.value;\n    setFormData({\n      ...formData,\n      client: clientId\n    });\n    \n    // Clear selected items when client changes\n    setSelectedTimeEntries([]);\n    setSelectedExpenses([]);\n    setTimeEntries([]);\n    setExpenses([]);\n    \n    if (clientId) {\n      fetchUnbilledItems(clientId);\n    }\n  };\n\n  const handleFormChange = (e) => {\n    const { name, value } = e.target;\n    setFormData({\n      ...formData,\n      [name]: value\n    });\n  };\n\n  const handleTimeEntrySelection = (id) => {\n    const newSelected = selectedTimeEntries.includes(id)\n      ? selectedTimeEntries.filter(entryId => entryId !== id)\n      : [...selectedTimeEntries, id];\n    \n    setSelectedTimeEntries(newSelected);\n    \n    // Calculate total based on new selection\n    const selectedEntries = timeEntries.filter(entry => newSelected.includes(entry.id));\n    calculateTotal(selectedEntries, expenses.filter(expense => selectedExpenses.includes(expense.id)));\n  };\n\n  const handleExpenseSelection = (id) => {\n    const newSelected = selectedExpenses.includes(id)\n      ? selectedExpenses.filter(expenseId => expenseId !== id)\n      : [...selectedExpenses, id];\n    \n    setSelectedExpenses(newSelected);\n    \n    // Calculate total based on new selection\n    const selectedExps = expenses.filter(expense => newSelected.includes(expense.id));\n    calculateTotal(timeEntries.filter(entry => selectedTimeEntries.includes(entry.id)), selectedExps);\n  };\n\n  const handleSelectAll = (type) => {\n    if (type === 'time') {\n      const allIds = timeEntries.map(entry => entry.id);\n      setSelectedTimeEntries(selectedTimeEntries.length === timeEntries.length ? [] : allIds);\n      calculateTotal(\n        selectedTimeEntries.length === timeEntries.length ? [] : timeEntries,\n        expenses.filter(expense => selectedExpenses.includes(expense.id))\n      );\n    } else {\n      const allIds = expenses.map(expense => expense.id);\n      setSelectedExpenses(selectedExpenses.length === expenses.length ? [] : allIds);\n      calculateTotal(\n        timeEntries.filter(entry => selectedTimeEntries.includes(entry.id)),\n        selectedExpenses.length === expenses.length ? [] : expenses\n      );\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!formData.client) {\n      setError('Please select a client');\n      return;\n    }\n    \n    if (selectedTimeEntries.length === 0 && selectedExpenses.length === 0) {\n      setError('Please select at least one time entry or expense');\n      return;\n    }\n    \n    setLoading(true);\n    setError(null);\n    \n    try {\n      // Create the invoice\n      const invoiceData = await apiRequest('/api/billing/invoices/', 'POST', formData);\n      \n      // Add time entries to the invoice\n      if (selectedTimeEntries.length > 0) {\n        await apiRequest(`/api/billing/invoices/${invoiceData.id}/add_time_entries/`, 'POST', {\n          time_entry_ids: selectedTimeEntries\n        });\n      }\n      \n      // Add expenses to the invoice\n      if (selectedExpenses.length > 0) {\n        await apiRequest(`/api/billing/invoices/${invoiceData.id}/add_expenses/`, 'POST', {\n          expense_ids: selectedExpenses\n        });\n      }\n      \n      toast.success('Invoice created successfully');\n      navigate(`/billing/invoices/${invoiceData.id}`);\n    } catch (err) {\n      console.error('Failed to create invoice:', err);\n      setError('Failed to create invoice. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatDate = (dateString) => {\n    if (!dateString) return 'N/A';\n    const date = new Date(dateString);\n    return new Intl.DateTimeFormat('en-US', { \n      year: 'numeric', \n      month: 'short', \n      day: 'numeric' \n    }).format(date);\n  };\n\n  const formatCurrency = (amount) => {\n    return `$${parseFloat(amount).toFixed(2)}`;\n  };\n\n  return (\n    <div>\n      <div className=\"mb-6 pb-4 border-b border-gray-200 dark:border-gray-700\">\n        <Link to=\"/billing/invoices\" className=\"text-sm text-primary-600 dark:text-primary-400 hover:underline flex items-center mb-2\">\n          <ArrowLeftIcon className=\"h-4 w-4 mr-1\" /> Back to Invoices\n        </Link>\n        <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white\">Create New Invoice</h2>\n      </div>\n\n      {error && (\n        <div className=\"rounded-md bg-red-50 dark:bg-red-900/30 p-4 mb-6\">\n          <div className=\"flex\">\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800 dark:text-red-200\">Error</h3>\n              <div className=\"mt-2 text-sm text-red-700 dark:text-red-300\">\n                <p>{error}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <div className=\"bg-white dark:bg-gray-800 shadow dark:shadow-gray-700/10 rounded-lg\">\n        <form onSubmit={handleSubmit}>\n          {/* Invoice Details */}\n          <div className=\"p-6 border-b border-gray-200 dark:border-gray-700\">\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">Invoice Details</h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div>\n                <label htmlFor=\"client\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                  Client <span className=\"text-red-500\">*</span>\n                </label>\n                <select\n                  id=\"client\"\n                  name=\"client\"\n                  value={formData.client}\n                  onChange={handleClientChange}\n                  required\n                  className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"\">Select a client</option>\n                  {clients.map(client => (\n                    <option key={client.id} value={client.id}>{client.first_name} {client.last_name}</option>\n                  ))}\n                </select>\n              </div>\n              <div>\n                {/* This would be auto-generated, so we just show a placeholder */}\n                <label htmlFor=\"invoice_number\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                  Invoice Number\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"invoice_number\"\n                  name=\"invoice_number\"\n                  disabled\n                  value=\"Auto-generated\"\n                  className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-600\"\n                />\n              </div>\n              <div>\n                <label htmlFor=\"issue_date\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                  Issue Date <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"date\"\n                  id=\"issue_date\"\n                  name=\"issue_date\"\n                  value={formData.issue_date}\n                  onChange={handleFormChange}\n                  required\n                  className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                />\n              </div>\n              <div>\n                <label htmlFor=\"due_date\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                  Due Date <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"date\"\n                  id=\"due_date\"\n                  name=\"due_date\"\n                  value={formData.due_date}\n                  onChange={handleFormChange}\n                  required\n                  className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                />\n              </div>\n              <div className=\"md:col-span-2\">\n                <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                  Notes\n                </label>\n                <textarea\n                  id=\"notes\"\n                  name=\"notes\"\n                  rows=\"3\"\n                  value={formData.notes}\n                  onChange={handleFormChange}\n                  className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  placeholder=\"Additional notes or payment instructions...\"\n                ></textarea>\n              </div>\n            </div>\n          </div>\n\n          {/* Time Entries Section */}\n          <div className=\"p-6 border-b border-gray-200 dark:border-gray-700\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">Time Entries</h3>\n              {timeEntries.length > 0 && (\n                <button\n                  type=\"button\"\n                  onClick={() => handleSelectAll('time')}\n                  className=\"text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 text-sm font-medium\"\n                >\n                  {selectedTimeEntries.length === timeEntries.length ? 'Deselect All' : 'Select All'}\n                </button>\n              )}\n            </div>\n            \n            {!formData.client ? (\n              <p className=\"text-gray-500 dark:text-gray-400\">Please select a client to view unbilled time entries.</p>\n            ) : timeEntries.length === 0 ? (\n              <p className=\"text-gray-500 dark:text-gray-400\">No unbilled time entries for this client.</p>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                  <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                    <tr>\n                      <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Select</th>\n                      <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Date</th>\n                      <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Description</th>\n                      <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Staff</th>\n                      <th scope=\"col\" className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Hours</th>\n                      <th scope=\"col\" className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Rate</th>\n                      <th scope=\"col\" className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Amount</th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                    {timeEntries.map(entry => (\n                      <tr \n                        key={entry.id} \n                        className={`cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 ${\n                          selectedTimeEntries.includes(entry.id) ? 'bg-blue-50 dark:bg-blue-900/20' : ''\n                        }`}\n                        onClick={() => handleTimeEntrySelection(entry.id)}\n                      >\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <input\n                            type=\"checkbox\"\n                            checked={selectedTimeEntries.includes(entry.id)}\n                            onChange={() => handleTimeEntrySelection(entry.id)}\n                            className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\n                          />\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300\">\n                          {formatDate(entry.date)}\n                        </td>\n                        <td className=\"px-6 py-4 text-sm text-gray-500 dark:text-gray-300\">\n                          <div className=\"max-w-xs truncate\">{entry.description}</div>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300\">\n                          {entry.user_detail ? `${entry.user_detail.first_name} ${entry.user_detail.last_name}` : 'Unknown'}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right\">\n                          {parseFloat(entry.hours).toFixed(2)}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right\">\n                          {formatCurrency(entry.rate)}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right\">\n                          {formatCurrency(entry.amount)}\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </div>\n\n          {/* Expenses Section */}\n          <div className=\"p-6 border-b border-gray-200 dark:border-gray-700\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">Expenses</h3>\n              {expenses.length > 0 && (\n                <button\n                  type=\"button\"\n                  onClick={() => handleSelectAll('expense')}\n                  className=\"text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 text-sm font-medium\"\n                >\n                  {selectedExpenses.length === expenses.length ? 'Deselect All' : 'Select All'}\n                </button>\n              )}\n            </div>\n            \n            {!formData.client ? (\n              <p className=\"text-gray-500 dark:text-gray-400\">Please select a client to view unbilled expenses.</p>\n            ) : expenses.length === 0 ? (\n              <p className=\"text-gray-500 dark:text-gray-400\">No unbilled expenses for this client.</p>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                  <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                    <tr>\n                      <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Select</th>\n                      <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Date</th>\n                      <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Description</th>\n                      <th scope=\"col\" className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\">Amount</th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                    {expenses.map(expense => (\n                      <tr \n                        key={expense.id} \n                        className={`cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 ${\n                          selectedExpenses.includes(expense.id) ? 'bg-blue-50 dark:bg-blue-900/20' : ''\n                        }`}\n                        onClick={() => handleExpenseSelection(expense.id)}\n                      >\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <input\n                            type=\"checkbox\"\n                            checked={selectedExpenses.includes(expense.id)}\n                            onChange={() => handleExpenseSelection(expense.id)}\n                            className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\n                          />\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300\">\n                          {formatDate(expense.date)}\n                        </td>\n                        <td className=\"px-6 py-4 text-sm text-gray-500 dark:text-gray-300\">\n                          {expense.description}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 text-right\">\n                          {formatCurrency(expense.amount)}\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </div>\n\n          {/* Invoice Summary and Submit */}\n          <div className=\"p-6\">\n            <div className=\"flex justify-between items-end\">\n              <div>\n                <p className=\"text-gray-500 dark:text-gray-400 text-sm\">\n                  {selectedTimeEntries.length} time entries selected â€¢ {selectedExpenses.length} expenses selected\n                </p>\n              </div>\n              <div className=\"text-right\">\n                <div className=\"mb-4\">\n                  <p className=\"text-sm text-gray-500 dark:text-gray-400\">Total Amount</p>\n                  <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">{formatCurrency(totalAmount)}</p>\n                </div>\n                <div className=\"flex space-x-3\">\n                  <Link\n                    to=\"/billing/invoices\"\n                    className=\"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\"\n                  >\n                    Cancel\n                  </Link>\n                  <button\n                    type=\"submit\"\n                    disabled={loading || !formData.client || (selectedTimeEntries.length === 0 && selectedExpenses.length === 0)}\n                    className=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50\"\n                  >\n                    {loading ? (\n                      <>\n                        <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                        </svg>\n                        Creating...\n                      </>\n                    ) : (\n                      <>\n                        <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n                        Create Invoice\n                      </>\n                    )}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default CreateInvoice;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}